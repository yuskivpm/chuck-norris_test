{"version":3,"sources":["store/joke-slice.ts","store/actions.ts","models/hooks.ts","components/more-button/more-button.tsx","components/joke-block/joke-block.tsx","App.jsx","utils/fetchAPI.ts","utils/storeAPI.ts","store/saga.js","store/index.ts","index.tsx"],"names":["jokeSlice","createSlice","name","initialState","jokes","error","reducers","addJoke","state","action","push","payload","handleError","updateJokes","selectJokes","selectError","fetchNextJoke","createAction","actions","useAppSelector","useSelector","MoreButton","dispatch","useDispatch","type","className","onClick","value","JokeBlock","text","App","message","map","id","a","fetch","data","json","DATA_KEY","loadFromStore","JSON","parse","localStorage","getItem","Array","isArray","e","fetchJokes","rootSaga","call","getNextJoke","joke","put","savedJokes","takeEvery","sagaMiddleware","createSagaMiddleware","middleware","getDefaultMiddleware","thunk","store","next","toString","getState","concat","setItem","stringify","configureStore","reducer","jokeReducer","run","saga","ReactDOM","render","document","getElementById"],"mappings":"mPAaMA,EAAYC,YAAY,CAC5BC,KAAM,cACNC,aAP8B,CAC9BC,MAAO,GACPC,MAAO,MAMPC,SAAU,CACRC,QAAS,SAACC,EAAOC,GACfD,EAAMJ,MAAMM,KAAKD,EAAOE,SACxBH,EAAMH,MAAQ,MAEhBO,YAAa,SAACJ,EAAOC,GACnBD,EAAMH,MAAQI,EAAOE,SAEvBE,YAAa,SAACL,EAAOC,GACnBD,EAAMJ,MAAQK,EAAOE,QACrBH,EAAMH,MAAQ,SAKPS,EAAc,SAACN,GAAD,OAAsBA,EAAMJ,OAC1CW,EAAc,SAACP,GAAD,OAAsBA,EAAMH,OAE1CW,EAAgBC,YClCK,mB,EDmCmBjB,EAAUkB,QAAhDX,E,EAAAA,QAASK,E,EAAAA,YAAaC,E,EAAAA,YAEtBb,IAAf,QEjCamB,EAAkDC,I,eCehDC,EAbI,WACjB,IAAMC,EDJ4BC,cCMlC,OACE,uBACEC,KAAK,SACLC,UAAU,cACVC,QAAS,kBAAMJ,EAASN,MACxBW,MAAM,aCJGC,G,MAJG,SAAC,GAAD,IAAGC,EAAH,EAAGA,KAAH,OAChB,qBAAKJ,UAAU,OAAf,SAAuBI,M,MCuBVC,MAvBf,WACE,IAAMzB,EAAQc,EAAeJ,GACvBX,EAAQe,EAAeL,GAE7B,OAAIT,EAEA,sBAAKoB,UAAU,YAAf,UACE,+CACA,4BAAIpB,EAAM0B,aAMd,sBAAKN,UAAU,MAAf,UACE,cAAC,EAAD,IACCrB,EAAM4B,KAAI,gBAAGC,EAAH,EAAGA,GAAIN,EAAP,EAAOA,MAAP,OACT,cAAC,EAAD,CAAWE,KAAMF,GAAYM,U,+CCpBrC,wBAAe,kCAAAC,EAAA,sEACMC,MAHL,6CAED,cACPC,EADO,gBAEeA,EAAKC,OAFpB,uBAELJ,EAFK,EAELA,GAAIN,EAFC,EAEDA,MAFC,kBAGN,CAAEM,KAAIN,UAHA,2CCFTW,EAAW,QAMJC,EAAgB,WAC3B,IACE,IAAMH,EAAeI,KAAKC,MACxBC,aAAaC,QAAQL,IARP,MAUhB,OAAOM,MAAMC,QAAQT,GAAQA,EAAO,GACpC,MAAOU,GACP,MAAO,K,WCTMC,G,WASQC,GATlB,SAAUD,IAAV,uEAEU,OAFV,kBAEgBE,YAAKC,GAFrB,OAGH,OADMC,EAFH,gBAGGC,YAAI7C,EAAQ4C,IAHf,8BAKH,OALG,mCAKGC,YAAIxC,EAAY,EAAD,KALlB,qDASQ,SAAUoC,IAAV,uEACM,OADN,SACYC,YAAKV,GADjB,OAEb,OADMc,EADO,gBAEPD,YAAIvC,EAAYwC,IAFT,OAGb,OAHa,SAGPC,YAAUtC,EAAe+B,GAHlB,uCCHf,IAUMQ,EAAiBC,cAEjBC,EAAU,sBACXC,YAAqB,CAAEC,OAAO,KADnB,CAEdJ,EAdiD,SAACK,GAAD,OAAW,SAACC,GAAD,OAAU,SACtEpD,GAEA,GAAIA,EAAOe,OAASjB,EAAQuD,WAAY,CAAC,IAC/B1D,EAAUwD,EAAMG,WAAhB3D,MFXgBgC,EEYZhC,EAAM4D,OAAOvD,EAAOE,SFXlC+B,aAAauB,QAAQ3B,EAAUE,KAAK0B,UAAU9B,IADrB,IAACA,EEc1ByB,EAAKpD,QAWDmD,EAAQO,YAAe,CAC3BC,QAASC,EACTZ,eAGFF,EAAee,IAAIC,GAEJX,Q,MC7BfY,IAASC,OACP,cAAC,IAAD,CAAUb,MAAOA,EAAjB,SACE,cAAC,EAAD,MAEFc,SAASC,eAAe,W","file":"static/js/main.5983f1b4.chunk.js","sourcesContent":["/* eslint-disable no-param-reassign */\r\nimport { createSlice, createAction, PayloadAction } from '@reduxjs/toolkit';\r\n\r\nimport { RootState } from '.';\r\nimport actions from './actions';\r\nimport Joke from '../models/joke';\r\nimport JokeState from '../models/joke-state';\r\n\r\nconst initialState: JokeState = {\r\n  jokes: [],\r\n  error: null,\r\n};\r\n\r\nconst jokeSlice = createSlice({\r\n  name: 'chuckNorris',\r\n  initialState,\r\n  reducers: {\r\n    addJoke: (state, action: PayloadAction<Joke>): void => {\r\n      state.jokes.push(action.payload);\r\n      state.error = null;\r\n    },\r\n    handleError: (state, action: PayloadAction<Error>) => {\r\n      state.error = action.payload;\r\n    },\r\n    updateJokes: (state, action: PayloadAction<Joke[]>): void => {\r\n      state.jokes = action.payload;\r\n      state.error = null;\r\n    },\r\n  },\r\n});\r\n\r\nexport const selectJokes = (state: RootState) => state.jokes;\r\nexport const selectError = (state: RootState) => state.error;\r\n\r\nexport const fetchNextJoke = createAction(actions.FETCH_NEXT_JOKE);\r\nexport const { addJoke, handleError, updateJokes } = jokeSlice.actions;\r\n\r\nexport default jokeSlice.reducer;\r\n","export default { FETCH_NEXT_JOKE: 'FETCH_NEXT_JOKE' };\r\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\r\nimport { RootState, AppDispatch } from '../store/index';\r\n\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n","import { fetchNextJoke } from '../../store/joke-slice';\r\n\r\nimport { useAppDispatch } from '../../models/hooks';\r\n\r\nimport './more-button.css';\r\n\r\nconst MoreButton = () => {\r\n  const dispatch = useAppDispatch();\r\n\r\n  return (\r\n    <input\r\n      type=\"button\"\r\n      className=\"more-button\"\r\n      onClick={() => dispatch(fetchNextJoke())}\r\n      value=\"MORE!!!\"\r\n    />\r\n  );\r\n};\r\n\r\nexport default MoreButton;\r\n","import './joke-block.css';\r\n\r\ninterface JokeBlockProps {\r\n  text: string;\r\n}\r\n\r\nconst JokeBlock = ({ text }: JokeBlockProps) => (\r\n  <div className=\"joke\">{text}</div>\r\n);\r\n\r\nexport default JokeBlock;\r\n","import MoreButton from './components/more-button';\nimport JokeBlock from './components/joke-block';\nimport { selectJokes, selectError } from './store/joke-slice';\nimport { useAppSelector } from './models/hooks';\n\nimport './App.css';\n\nfunction App() {\n  const error = useAppSelector(selectError);\n  const jokes = useAppSelector(selectJokes);\n\n  if (error) {\n    return (\n      <div className=\"App error\">\n        <h2>Fetch failed:</h2>\n        <p>{error.message}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"App\">\n      <MoreButton />\n      {jokes.map(({ id, value }) => (\n        <JokeBlock text={value} key={id} />\n      ))}\n    </div>\n  );\n}\n\nexport default App;\n","import Joke from '../models/joke';\r\n\r\nconst API_URL = '  https://api.chucknorris.io/jokes/random';\r\n\r\nexport default async (): Promise<Joke> => {\r\n  const data = await fetch(API_URL);\r\n  const { id, value } = await data.json();\r\n  return { id, value };\r\n};\r\n","import Joke from '../models/joke';\r\n\r\nconst DATA_KEY = 'JOKES';\r\nconst EMPTY_ARRAY = '[]';\r\n\r\nexport const saveToStore = (data: Joke[]): void =>\r\n  localStorage.setItem(DATA_KEY, JSON.stringify(data));\r\n\r\nexport const loadFromStore = (): Joke[] => {\r\n  try {\r\n    const data: Joke[] = JSON.parse(\r\n      localStorage.getItem(DATA_KEY) || EMPTY_ARRAY\r\n    );\r\n    return Array.isArray(data) ? data : [];\r\n  } catch (e) {\r\n    return [] as Joke[];\r\n  }\r\n};\r\n","import { call, put, takeEvery } from 'redux-saga/effects';\r\n\r\nimport getNextJoke from '../utils/fetchAPI';\r\nimport { loadFromStore } from '../utils/storeAPI';\r\nimport { addJoke, handleError, fetchNextJoke, updateJokes } from './joke-slice';\r\n\r\nexport function* fetchJokes() {\r\n  try {\r\n    const joke = yield call(getNextJoke);\r\n    yield put(addJoke(joke));\r\n  } catch (error) {\r\n    yield put(handleError(error));\r\n  }\r\n}\r\n\r\nexport default function* rootSaga() {\r\n  const savedJokes = yield call(loadFromStore);\r\n  yield put(updateJokes(savedJokes));\r\n  yield takeEvery(fetchNextJoke, fetchJokes);\r\n}\r\n","import {\r\n  configureStore,\r\n  getDefaultMiddleware,\r\n  Middleware,\r\n} from '@reduxjs/toolkit';\r\nimport createSagaMiddleware from 'redux-saga';\r\n\r\nimport saga from './saga';\r\nimport JokeState from '../models/joke-state';\r\nimport { saveToStore } from '../utils/storeAPI';\r\nimport jokeReducer, { addJoke } from './joke-slice';\r\n\r\nconst storeMiddleware: Middleware<{}, JokeState> = (store) => (next) => (\r\n  action\r\n) => {\r\n  if (action.type === addJoke.toString()) {\r\n    const { jokes } = store.getState();\r\n    saveToStore(jokes.concat(action.payload));\r\n  }\r\n  next(action);\r\n};\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\n\r\nconst middleware = [\r\n  ...getDefaultMiddleware({ thunk: false }),\r\n  sagaMiddleware,\r\n  storeMiddleware,\r\n];\r\n\r\nconst store = configureStore({\r\n  reducer: jokeReducer,\r\n  middleware,\r\n});\r\n\r\nsagaMiddleware.run(saga);\r\n\r\nexport default store;\r\n\r\nexport type RootState = ReturnType<typeof store.getState>;\r\nexport type AppDispatch = typeof store.dispatch;\r\n","import ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport App from './App';\nimport store from './store';\n\nimport './index.css';\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}